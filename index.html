<!doctype html>
<html lang="pt-br">
<head>
    <title>Catálogo</title>
    <meta charset="UTF-8">
    <link rel="icon" href="application/imagens/favicon.ico" type="image/x-icon">
    <meta name="description" content="Pulseiras & Colares de Pedras Naturais.">
    <meta name="robots" content="noindex, nofollow">
    <meta name="theme-color" content="#0d6efd">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="application/css/style.css">
    <link rel="manifest" href="/manifest.json">

    <!-- Ícones para fallback -->
    <link rel="icon" href="icons/icon-192x192.png">
   
    <script src="application/js/jquery.min.1.7.js"></script>
    <script src="application/js/jquery-ui-1.8.20.full.min.js"></script>
    <script src="application/js/modernizr.2.5.3.min.js"></script>
    <script src="application/js/hash.js"></script>
    <script src="application/js/page.js" ></script>
    <link rel="stylesheet" type="text/css" href="application/css/fronte.css">



<!-- Botão de abrir menu -->
 <button id="menuToggle" class="menu-toggle"><i class="fa fa-bars" ></i>&ensp;Produtos</button>

<!-- Overlay -->
<div id="overlay" class="overlay"></div>

<!-- Sidebar -->
<div id="sidebar" class="sidebar">
    <!-- Botão recolher dentro da sidebar -->
    <button id="sidebarClose" class="sidebar-close-btn" title="Fechar"><i class="fa fa-reply"></i>&ensp;Voltar</button>

    <ul>
        <li class="menu-item"> 
           <img src="application/imagens/puls.png">&emsp;Pulseira &emsp;&emsp;&ensp;<span aria-hidden="true" class="fa fa-chevron-down"></span>
            <ul class="submenu">
                <li data-page="3"><img src="application/imagens/man.png">&emsp;Homem</li>
                <li data-page="10"><img src="application/imagens/female.png">&emsp;Mulher</li>
            </ul>
        </li>
        <li class="menu-item">
            <img src="application/imagens/colar.png">&emsp;Colar &emsp;&emsp;&emsp;&ensp;<span aria-hidden="true" class="fa fa-chevron-down"></span>
            <ul class="submenu">
                <li data-page="2"><img src="application/imagens/man.png">&emsp;Homem</li>
                <li data-page="16"><img src="application/imagens/female.png">&emsp;Mulher</li>
            </ul>
        </li>
        <li class="menu-item">
            <img src="application/imagens/cart.png">&emsp;Carteira &emsp;&emsp;&ensp;<span aria-hidden="true" class="fa fa-chevron-down"></span>
            <ul class="submenu">
                <li data-page="9"><img src="application/imagens/man.png">&emsp;Homem</li>
            </ul>
        </li>
    </ul>
</div>

<div class="logo-backs"></div>
<audio id="audio" src="application/song/page-flip.mp3"></audio>

<div id="canvas">
    <div class="controls-pdf">
        <div class="controlzoom" style="display:none">
            <a href="#" id="zoomin"><img src="application/imagens/zoomin.png" /></a>
            <a href="#" id="zoomout"><img src="application/imagens/zoomout.png" /></a>
        </div>
        <div class="zoom-icon zoom-icon-in"></div>
        <input type="image" class="fs" src="application/imagens/fs.png" onclick="openFullscreen();"/>
        <a href="#" id="prev"></a>
        <a href="#" id="next"></a>
    </div>
    <div class="magazine-viewport" id="flipfull">
        <div class="container">
            <div class="magazine">
                <div ignore="1" class="next-button"></div>
                <div ignore="1" class="previous-button"></div>
            </div>
        </div>
    </div>
</div>

<!-- Barra fixa inferior -->
<div id="flipbar">
    <button id="thumb-toggle" title="Mostrar/ocultar miniaturas"> <i class="fa-solid fa-book-open" style=" color: #FFF8DC;"></i></button>
    <div class="flipbar__thumbs"></div> 
    <a class="flipbar__wa" href="https://wa.me/5511951300490" title="Fale conosco no WhatsApp">
        <i class="fab fa-whatsapp"></i>
        <span>Pedidos</span>
    </a>
</div>

<script src="application/js/core_single.js"></script>
<script>
    yepnope({
        test: Modernizr.csstransforms,
        yep: ['application/js/turn.min.js'],
        nope: ['application/js/turn.html4.min.js', 'application/css/jquery.ui.html4.css'],
        both: ['application/js/zoom.min.js', 'application/css/jquery.ui.css', 'application/js/magazineSINGLEoff.js', 'application/css/magazine_single.css'],
        complete: loadApp
    });

    const thumbsContainer = document.querySelector(".flipbar__thumbs");
    const toggleBtn = document.getElementById("thumb-toggle");

    toggleBtn.addEventListener("click", function(){
        thumbsContainer.classList.toggle("active");

        if (thumbsContainer.classList.contains("active")) {
            const thumbs = thumbsContainer.querySelectorAll(".flipbar__thumb");
            thumbs.forEach((thumb, index) => {
                thumb.style.transitionDelay = (index * 0.08) + "s";
            });
        } else {
            const thumbs = thumbsContainer.querySelectorAll(".flipbar__thumb");
            thumbs.forEach((thumb) => {
                thumb.style.transitionDelay = "0s";
            });
        }
    });

    // Drag-to-scroll com mouse
    let isDown = false;
    let startX;
    let scrollLeft;

    thumbsContainer.addEventListener("mousedown", (e) => {
        isDown = true;
        startX = e.pageX - thumbsContainer.offsetLeft;
        scrollLeft = thumbsContainer.scrollLeft;
    });
    thumbsContainer.addEventListener("mouseleave", () => isDown = false);
    thumbsContainer.addEventListener("mouseup", () => isDown = false);
    thumbsContainer.addEventListener("mousemove", (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - thumbsContainer.offsetLeft;
        const walk = (x - startX) * 1.5;
        thumbsContainer.scrollLeft = scrollLeft - walk;
    });

    // Drag-to-scroll no touch
    let touchStartX = 0;
    let touchScrollLeft = 0;

    thumbsContainer.addEventListener("touchstart", (e) => {
        touchStartX = e.touches[0].pageX;
        touchScrollLeft = thumbsContainer.scrollLeft;
    });
    thumbsContainer.addEventListener("touchmove", (e) => {
        const touchX = e.touches[0].pageX;
        const move = (touchX - touchStartX) * 1.5;
        thumbsContainer.scrollLeft = touchScrollLeft - move;
    });

    if (thumbsContainer.classList.contains("active")) {
    const thumbs = thumbsContainer.querySelectorAll(".flipbar__thumb");
    thumbs.forEach((thumb, index) => {
        thumb.style.animationDelay = (index * 0.08) + "s";
    });
} else {
    const thumbs = thumbsContainer.querySelectorAll(".flipbar__thumb");
    thumbs.forEach((thumb) => {
        thumb.style.animationDelay = "0s";
    });
}

/* ===== Atualiza destaque da miniatura ao mudar página ===== */
function updateActiveThumbnail(page) {
    document.querySelectorAll(".flipbar__thumb").forEach(thumb => {
        thumb.classList.remove("active-thumb");
    });
    const activeThumb = document.querySelector(`.flipbar__thumb[data-page="${page}"]`);
    if (activeThumb) activeThumb.classList.add("active-thumb");
}

/* Ao criar as miniaturas já coloco data-page */
for (let i = 1; i <= flipbookcfg.numPages; i++) {
    let btn = document.createElement("button");
    btn.className = "flipbar__thumb " + (i % 2 === 0 ? "from-left" : "from-right");
    btn.setAttribute("data-page", i);
    btn.innerHTML = `
        <img src="${flipbookcfg.url}${i}-thumb.jpg" alt="Página ${i}">
        <span>${i}</span>
    `;
    btn.addEventListener("click", function () {
        $(".magazine").turn("page", i);
        thumbsContainer.classList.remove("active");
    });
    thumbsContainer.appendChild(btn);
}

/* Detecta mudança de página no flipbook */
$(".magazine").bind("turned", function (e, page) {
    updateActiveThumbnail(page);
});

        document.querySelectorAll(".menu-item").forEach(item => {
            item.addEventListener("click", () => item.classList.toggle("open"));
        });

        document.querySelectorAll(".submenu li").forEach(sub => {
            sub.addEventListener("click", e => {
                const page = e.target.getAttribute("data-page");
                if (page) $(".magazine").turn("page", parseInt(page));
                sidebar.classList.remove("open");
                overlay.style.display = "none";
                e.stopPropagation();
            });
        });

/* Sidebar toggle */
const sidebar = document.getElementById("sidebar");
const overlay = document.getElementById("overlay");
const menuToggle = document.getElementById("menuToggle");
const sidebarClose = document.getElementById("sidebarClose");

menuToggle.addEventListener("click", () => {
    sidebar.classList.add("open");
    overlay.style.display = "block";
});

overlay.addEventListener("click", () => {
    sidebar.classList.remove("open");
    overlay.style.display = "none";
});

/* Botão de fechar dentro da sidebar */
sidebarClose.addEventListener("click", () => {
    sidebar.classList.remove("open");
    overlay.style.display = "none";
});

</script>
<script>
/* ========= fullscreen ========= */
var elem = document.getElementById("flipfull");
function openFullscreen() {
  if (elem.requestFullscreen) elem.requestFullscreen();
  else if (elem.mozRequestFullScreen) elem.mozRequestFullScreen();
  else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
  else if (elem.webkitEnterFullscreen) elem.webkitEnterFullscreen();
}
</script>
<script src="app.js"></script>

</body>
</html>
